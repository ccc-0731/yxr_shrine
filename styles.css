:root{
  /* 米色 / 深绿 / 酒红 */
  --paper: #f4efe2;
  --paper2:#efe7d2;
  --ink:   #1f2a1f;
  --muted: #6c6a5f;

  --green: #1f4d3a;     /* 深绿 */
  --green2:#2a6a50;
  --wine:  #6b1f2a;     /* 酒红 */
  --wine2: #8a2b3a;

  --card: rgba(244,239,226,0.86);
  --card2: rgba(239,231,210,0.72);
  --shadow: 0 10px 30px rgba(24, 18, 10, 0.18);

  --ring: rgba(31,77,58,0.18);
  --stroke: rgba(31,42,31,0.12);
}

*{box-sizing:border-box}
html,body{height:100%}

body{
  margin:0;
  font-family: -apple-system, BlinkMacSystemFont, "PingFang SC","Hiragino Sans GB","Microsoft YaHei", Segoe UI, Roboto, Arial, sans-serif;
  color: var(--ink);
  background: radial-gradient(1200px 600px at 20% 0%, #fff7e6 0%, var(--paper) 40%, #f1ead7 100%);
  min-height:100vh;
  display:flex;
  flex-direction:column;
  -webkit-font-smoothing:antialiased;
}

/* 低 opacity 背景图层（你要的若隐若现） */
body::before{
  content:"";
  position:fixed;
  inset:0;
  background-image: url("yxr_shrine.png");
  background-size: cover;
  background-position: center;
  opacity: 0.10;          /* 这里调低/调高都行 */
  filter: saturate(0.9) contrast(0.95);
  pointer-events:none;
  z-index:-2;
}

/* 再加一层淡淡纹理，像“古书页” */
body::after{
  content:"";
  position:fixed;
  inset:0;
  background:
    radial-gradient(circle at 10% 20%, rgba(107,31,42,0.06), transparent 45%),
    radial-gradient(circle at 80% 10%, rgba(31,77,58,0.06), transparent 45%),
    radial-gradient(circle at 50% 90%, rgba(31,42,31,0.04), transparent 55%);
  pointer-events:none;
  z-index:-1;
}

.mono{font-variant-numeric: tabular-nums; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
.hidden{display:none !important;}

.topbar{
  position:sticky;
  top:0;
  z-index:10;
  display:flex;
  gap:16px;
  align-items:center;
  justify-content:space-between;
  padding:14px 16px;
  border-bottom: 1px solid var(--stroke);
  background: rgba(244,239,226,0.88);
  backdrop-filter: blur(8px);
}

.brand-title{
  font-size: 20px;
  font-weight: 900;
  letter-spacing: 2px;
}
.brand-subtitle{
  font-size: 12px;
  color: var(--muted);
  margin-top: 2px;
}

.meters{
  display:flex;
  gap:14px;
  flex: 1;
  justify-content:center;
  max-width: 560px;
}
.meter{min-width: 220px;}
.meter-label{
  font-size: 12px;
  color: var(--muted);
  display:flex;
  justify-content:space-between;
  margin-bottom:6px;
}
.meter-track{
  height:10px;
  border-radius:999px;
  background: rgba(31,42,31,0.08);
  overflow:hidden;
  border: 1px solid rgba(31,42,31,0.08);
}
.meter-fill{
  height:100%;
  width: 0%;
  background: linear-gradient(90deg, rgba(31,77,58,0.9), rgba(42,106,80,0.9));
  border-radius:999px;
  transition: width 220ms ease;
}
.meter-fill.luck{
  background: linear-gradient(90deg, rgba(107,31,42,0.9), rgba(138,43,58,0.9));
}

.top-actions{
  display:flex;
  gap:10px;
  align-items:center;
}

.layout{
  width:100%;
  max-width: 980px;
  margin: 18px auto 0;
  padding: 0 16px 18px;
  display:flex;
  flex-direction:column;
  gap: 16px;
}

.card{
  background: linear-gradient(180deg, var(--card), var(--card2));
  border: 1px solid var(--stroke);
  border-radius: 16px;
  box-shadow: var(--shadow);
  overflow:hidden;
}

.card-header{
  padding: 14px 16px 10px;
  border-bottom: 1px dashed rgba(31,42,31,0.14);
  display:flex;
  align-items:baseline;
  justify-content:space-between;
  gap: 12px;
}
.card-header h2{
  margin:0;
  font-size: 18px;
  letter-spacing:1px;
}
.mini-stats{
  color: var(--muted);
  font-size: 12px;
  display:flex;
  gap:8px;
  align-items:center;
  flex-wrap:wrap;
}
.dot{opacity:0.6}

.card-body{
  padding: 14px 16px 16px;
}

.action-row{
  display:flex;
  gap: 12px;
  align-items:center;
  flex-wrap:wrap;
}

.toast{
  flex:1;
  min-width: 220px;
  padding: 10px 12px;
  border-radius: 12px;
  background: rgba(255,255,255,0.45);
  border: 1px solid rgba(31,42,31,0.10);
  color: var(--muted);
}

.cooldown{
  font-size: 12px;
  color: var(--muted);
  padding: 8px 10px;
  border-radius: 999px;
  border: 1px solid rgba(31,42,31,0.10);
  background: rgba(255,255,255,0.35);
}

/* Buttons */
.btn{
  border: 1px solid rgba(31,42,31,0.14);
  background: rgba(255,255,255,0.35);
  color: var(--ink);
  padding: 10px 12px;
  border-radius: 12px;
  cursor:pointer;
  font-weight: 800;
  transition: transform .08s ease, box-shadow .12s ease, opacity .12s ease, background .12s ease;
  box-shadow: 0 6px 16px rgba(24,18,10,0.10);
}
.btn:active{transform: translateY(1px)}
.btn:disabled{opacity:0.55; cursor:not-allowed; box-shadow:none;}

.btn-big{padding: 12px 16px; font-size: 15px; letter-spacing: 0.5px;}
.btn-ghost{
  background: transparent;
  box-shadow:none;
}
.btn-green{
  background: linear-gradient(90deg, rgba(31,77,58,0.95), rgba(42,106,80,0.95));
  color: #f7f3e8;
  border-color: rgba(31,77,58,0.35);
}
.btn-wine{
  background: linear-gradient(90deg, rgba(107,31,42,0.95), rgba(138,43,58,0.95));
  color: #f7f3e8;
  border-color: rgba(107,31,42,0.35);
}

/* Incense stage */
.incense-stage-wrap{
  margin-top: 14px;
}
.stage-title{
  font-size: 12px;
  color: var(--muted);
  margin-bottom: 10px;
}
.incense-stage{
  position:relative;
  height: 170px;
  border-radius: 14px;
  border: 1px solid rgba(31,42,31,0.12);
  background:
    linear-gradient(180deg, rgba(255,255,255,0.20), rgba(255,255,255,0.05)),
    radial-gradient(700px 220px at 20% 20%, rgba(31,77,58,0.08), transparent 50%),
    radial-gradient(700px 220px at 90% 70%, rgba(107,31,42,0.08), transparent 55%);
  overflow:hidden;
}

/* 香：会留在台子上 */
.incense-stick{
  position:absolute;
  width: 10px;
  height: 58px;
  bottom: 18px;
  border-radius: 8px;
  background: linear-gradient(180deg, #8b5a38, #6e4027);
  box-shadow: inset -2px -2px 6px rgba(255,255,255,0.18);
}
.incense-stick::after{
  content:"";
  position:absolute;
  top:-10px;
  left:50%;
  transform:translateX(-50%);
  width: 10px;
  height: 14px;
  border-radius: 8px;
  background: radial-gradient(circle at 50% 30%, rgba(255,208,120,1), rgba(255,108,70,0.2));
  filter: blur(0.2px);
  opacity: 0.9;
}

.smoke{
  position:absolute;
  bottom: 78px;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.85), rgba(255,255,255,0.0) 60%);
  filter: blur(6px);
  opacity: 0.9;
  animation: smokeUp 1800ms ease-out forwards;
}
@keyframes smokeUp{
  0%{transform: translateY(0) scale(0.7); opacity:0.85}
  60%{opacity:0.55}
  100%{transform: translateY(-110px) scale(1.35); opacity:0}
}

/* Fortune card */
.fortune-card{
  margin-top: 14px;
  padding: 14px 14px 12px;
  border-radius: 14px;
  border: 1px solid rgba(31,42,31,0.10);
  background: rgba(255,255,255,0.45);
}
.fortune-card.empty{opacity:0.9;}
.fortune-top{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}
.fortune-level{
  font-size: 22px;
  font-weight: 1000;
  letter-spacing: 1px;
}
.fortune-tag{
  font-size: 12px;
  color: var(--muted);
  border: 1px solid rgba(31,42,31,0.10);
  background: rgba(255,255,255,0.30);
  padding: 6px 10px;
  border-radius: 999px;
}
.fortune-text{
  margin-top: 10px;
  font-size: 14px;
  color: #2b2a24;
  line-height: 1.55;
}
.fortune-footer{
  margin-top: 10px;
  color: var(--muted);
  font-size: 12px;
}

/* luck styles */
.luck-great{border-left: 8px solid rgba(31,77,58,0.65);}
.luck-good{ border-left: 8px solid rgba(42,106,80,0.55);}
.luck-small{border-left: 8px solid rgba(107,31,42,0.45);}
.luck-odd{  border-left: 8px solid rgba(31,42,31,0.35);}
.luck-bad{  border-left: 8px solid rgba(107,31,42,0.75); background: rgba(255,255,255,0.35);}

/* Modal */
.modal{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index: 50;
}
.modal-backdrop{
  position:absolute;
  inset:0;
  background: rgba(20,18,14,0.35);
  backdrop-filter: blur(6px);
}
.modal-panel{
  position:relative;
  width:min(560px, calc(100vw - 28px));
  background: linear-gradient(180deg, rgba(244,239,226,0.94), rgba(239,231,210,0.88));
  border-radius: 16px;
  border: 1px solid rgba(31,42,31,0.14);
  box-shadow: 0 18px 60px rgba(10,8,6,0.35);
  padding: 14px;
}
.modal-title{
  font-weight: 1000;
  letter-spacing: 1px;
  margin-bottom: 10px;
}
.modal-content{
  color: #2b2a24;
  line-height: 1.55;
}
.modal-actions{
  margin-top: 12px;
  display:flex;
  justify-content:flex-end;
}
.modal img{
  width:100%;
  border-radius: 12px;
  border: 1px solid rgba(31,42,31,0.12);
  box-shadow: 0 10px 26px rgba(24,18,10,0.16);
}

/* Expel overlay */
.expel{
  position:fixed;
  inset:0;
  z-index: 60;
  display:flex;
  align-items:center;
  justify-content:center;
  background: rgba(20,18,14,0.55);
  backdrop-filter: blur(8px);
}
.expel-panel{
  width:min(520px, calc(100vw - 28px));
  border-radius: 16px;
  padding: 16px;
  background: linear-gradient(180deg, rgba(107,31,42,0.92), rgba(55,16,22,0.92));
  color: #f7f3e8;
  border: 1px solid rgba(255,255,255,0.18);
  box-shadow: 0 18px 60px rgba(10,8,6,0.45);
}
.expel-title{
  font-size: 22px;
  font-weight: 1100;
  letter-spacing: 1px;
}
.expel-text{
  margin-top: 10px;
  opacity: 0.9;
  line-height: 1.55;
}

/* Footer */
.footer{
  max-width: 980px;
  width: 100%;
  margin: 0 auto;
  padding: 10px 16px 16px;
  display:flex;
  justify-content:space-between;
  color: var(--muted);
  font-size: 12px;
}

/* Responsive */
@media (max-width: 720px){
  .topbar{flex-wrap:wrap; gap:10px;}
  .meters{order: 3; width:100%; max-width:none; justify-content:stretch;}
  .meter{flex:1; min-width: 160px;}
  .top-actions{order: 2;}
}
